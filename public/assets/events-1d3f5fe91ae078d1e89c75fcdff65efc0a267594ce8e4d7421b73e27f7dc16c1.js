function hideAttendees(){$("input[id=submit]").data("id")||$("#attendees-section").hide()}function grabId(){let t=$("#event_contacts_name").val();return $("#contacts_autocomplete option").filter(function(){return this.value==t}).data("id")}function lookupInBox(){$.get("/contacts/"+grabId()+".json",function(){$("#more-div").html(printInfo(contact))})}function printInfo(t){let e;return e=t.id?`<label>Name:</label> ${t.name}<br>\n    <label>Email:</label> ${t.email}<br>\n    <label>Last Attended:</label> ${t.lastAttended()}<br>\n    <label>Created On:</label> ${t.cleanTimestamp()}<br>\n    <label>Staff:</label> ${t.staff} `:"This contact hasn't been created yet. Use the add button to create a new contact."}function infoButton(t,e,n){return`<div id="small_button_${e}" class="btn btn-primary btn-sm">${t}\n  <a href="#" class="more-button" data-id="${e}">\n  <i class="material-icons inverse">info</i></a>\n  <a href="#" class="remove-button" data-contact-id="${e}" data-event-id="${n}">\n  <i class="material-icons inverse">remove_circle</i></a> </div>`}function attachInfoListeners(){$(".more-button").on("click",function(t){t.preventDefault();let e=$(this).data("id");$.get("/contacts/"+e+".json",function(t){let e=new Contact(t);$("#more-div").html(printInfo(e))})})}function attachLookupListeners(){$(".lookup-button").on("click",function(t){t.preventDefault(),$("#event_contacts_name").val()&&$.get("/contacts/"+grabId()+".json",function(t){let e=new Contact(t);$("#more-div").html(printInfo(e))})})}function attachAddListeners(){$(".add-button").on("click",function(t){t.preventDefault();let e=grabId();if($("#event_contacts_name").val()&&!$("#small_button_"+e).length){let t=$(this).data("id"),n=window.location.pathname;n=n.substring(0,n.length-5);let a=$("form.add-attendees").serializeArray(),i=$('meta[name="csrf-token"]').attr("content");a.forEach(function(t){"authenticity_token"==t.name&&(t.value=i)}),a.push({name:"event[contacts][id]",value:grabId()}),a.push({name:"_method",value:"patch"});let s=findName(a);$.ajax({type:"PATCH",url:n,dataType:"json",data:a,beforeSend:function(t){t.setRequestHeader("authenticity_token",a[1])}}).done(function(){$("#attendees").prepend(infoButton(s,e,t)),attachInfoListeners(),attachRemoveListeners(),$("#event_contacts_name").val("")})}})}function findName(t){return t.find(function(t){return"event[contacts][name]"==t.name}).value}function attachRemoveListeners(){$(".remove-button").on("click",function(t){t.preventDefault();let e="/events/"+$(this).data("event-id"),n=$(this).data("contact-id"),a=$("form.add-attendees").serializeArray();a.push({name:"event[contacts][id]",value:n}),$.ajax({type:"PATCH",url:e,dataType:"json",data:a}),$("#small_button_"+String(n)).remove()})}function attachSubmitListeners(){$("input[id=submit]").on("click",function(t){t.preventDefault();let e=$(this).data("id"),n=$("form.main-details").serializeArray();e?$.ajax({type:"PATCH",url:"/events/"+e,dataType:"json",data:n}).done(function(t){if(t.name){window.history.pushState(t,"",`/events/${t.id}/edit`);let e=new Event(t);$("#info-container").hide(),$("#attendees-section").show(),$("#form-wrapper").html(eventCardWrapper(e))}else alert("Please make sure the name field is filled out and try again")}):$.ajax({type:"POST",url:"/events",dataType:"json",data:n}).done(function(t){if(t){window.history.pushState(t,"",`/events/${t.id}/edit`);let e=new Event(t);$("#info-container").hide(),$("#attendees-section").show(),$("#form-wrapper").html(eventCardWrapper(e))}else alert("Please make sure the name field is filled out and try again")})})}function eventCardWrapper(t){return`<div class="row justify-content-center center-this-div">\n     <div class="col-lg-5 justify-content-center">\n         <div class="card card-stats">\n           <div class="card-header card-header-icon">\n             <div class="card-icon">\n               <i class="material-icons">info</i>\n             </div>\n           <h3 class="card-title">Event Info</h3>\n           <p class="card-category">\n           <label>Event date:</label> ${t.date}<br>\n           <label>Event name:</label> ${t.name}<br>\n           <label>Staff Count:</label> ${t.staff_count}<br>\n           <label>Guest Count:</label> ${t.guest_count}<br>\n           </p>\n        </div>\n      </div>\n    </div>\n  <div class="col-lg-5 justify-content-center">\n      <div class="card card-stats">\n        <div class="card-header card-header-icon">\n          <div class="card-icon">\n            <i class="material-icons">zoom_in</i>\n          </div>\n        <h3 class="card-title">Contact Info</h3>\n        <p class="card-category" id="more-div">\n          Drill down by selecting any info icon on the page\n        </div>\n      </p>\n     </div>\n   </div>\n <div class="col-lg-2 text-center">\n    <a href="/events" class="btn btn-primary btn-block">  All  Events  <i class="material-icons">event</i></a>\n    <a href="/events/${t.id}/" class="btn btn-primary btn-block">  View  Event  <i class="material-icons">zoom_in</i></a>\n    <a href="/events/${t.id}/edit" class="btn btn-primary btn-block">Modify Info <i class="material-icons">edit</i></a>\n </div>\n  </div>\n </div>\n   </div>`}$(document).ready(function(){attachSubmitListeners(),attachInfoListeners(),attachLookupListeners(),attachAddListeners(),attachRemoveListeners(),hideAttendees()});class Contact{constructor(t){this.id=t.id,this.name=t.name,this.email=t.email,this.major=t.major,this.staff=t.user.email,this.events=t.events,this.timestamp=t.created_at}lastAttended(){return this.events.length>0?this.events[0].name+" on "+this.events[0].date:"N/A"}}class Event{constructor(t){this.id=t.id,this.name=t.name,this.date=t.date,this.timestamp=t.created_at,this.contacts=t.contacts,this.staff_count=t.staff_count,this.guest_count=t.guest_count}}Contact.prototype.cleanTimestamp=function(){return this.timestamp.split("T")[0]};